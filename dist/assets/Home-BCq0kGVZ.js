const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B2h1eFxR.js","assets/index-DgsTEpUf.js","assets/index-CXpOtwDC.css"])))=>i.map(i=>d[i]);
import{_ as e,r as a,m as s,n as t,p as l,q as o,s as i,c,o as n,b as r,d,x as u,e as v,v as h,y as p,F as m,l as g,t as k,h as b,i as w,T as x,z as y,A as f,u as C}from"./index-DgsTEpUf.js";import{g as B,s as M}from"./product-DTdrY-bL.js";import"./request-DczqgLPf.js";const _={class:"home"},z={class:"navbar"},I={class:"nav-container"},$={class:"nav-search"},S={class:"nav-actions"},V={key:0,class:"badge"},H={key:0,class:"badge"},E={class:"user-menu"},j=["src","alt"],T={key:0,class:"dropdown-menu"},q={class:"menu-header"},A=["src","alt"],L={class:"menu-name"},O={class:"menu-id"},J={class:"products-section"},N={key:0,class:"products-grid"},D=["onClick"],F={class:"product-image-wrapper"},K=["src","alt"],P={class:"product-info"},R={class:"product-title"},U={class:"product-meta"},G={class:"product-price"},Q={class:"product-views"},W={key:1,class:"empty-state"},X='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%2386868b"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>',Y=e({__name:"Home",setup(e){const Y=C(),Z=a([]),ee=a(""),ae=a(!1),se=s(()=>{const e=localStorage.getItem("userInfo");return e?JSON.parse(e):null}),te=a(0),le=()=>{const e=JSON.parse(localStorage.getItem("chatContacts")||"[]");te.value=e.reduce((e,a)=>e+(a.unreadCount||0),0)},oe=()=>{le()},ie=async()=>{const e=await B();Z.value=e.data||[]},ce=async()=>{if(ee.value.trim()){const e=await M(ee.value);Z.value=e.data||[]}else ie()},ne=()=>{localStorage.removeItem("token"),localStorage.removeItem("userInfo"),ae.value=!1,Y.push("/login")},re=()=>{var e;(null==(e=se.value)?void 0:e.emailVerified)?Y.push("/publish"):f(async()=>{const{ElMessageBox:e}=await import("./index-B2h1eFxR.js");return{ElMessageBox:e}},__vite__mapDeps([0,1,2])).then(({ElMessageBox:e})=>{e.confirm("发布商品需要先完成邮箱验证，是否前往验证？","提示",{confirmButtonText:"去验证",cancelButtonText:"取消"}).then(()=>Y.push("/email-verify")).catch(()=>{})})};return t(()=>{ie(),le(),l(oe)}),o(()=>{i(oe)}),(e,a)=>(n(),c("div",_,[r("nav",z,[r("div",I,[r("div",{class:"nav-brand",onClick:a[0]||(a[0]=a=>e.$router.push("/"))},[...a[11]||(a[11]=[r("svg",{class:"brand-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),r("polyline",{points:"9,22 9,12 15,12 15,22"})],-1),r("span",null,"校园集市",-1)])]),r("div",$,[a[12]||(a[12]=r("svg",{class:"search-icon",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("circle",{cx:"11",cy:"11",r:"8"}),r("path",{d:"m21 21-4.35-4.35"})],-1)),v(r("input",{"onUpdate:modelValue":a[1]||(a[1]=e=>ee.value=e),type:"text",placeholder:"搜索你想要的宝贝...",onKeyup:p(ce,["enter"])},null,544),[[h,ee.value]])]),r("div",S,[se.value?(n(),c(m,{key:0},[r("button",{class:"btn-publish",onClick:re},[...a[13]||(a[13]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r("line",{x1:"5",y1:"12",x2:"19",y2:"12"})],-1),g(" 发布 ",-1)])]),r("button",{class:"btn-icon",onClick:a[2]||(a[2]=a=>e.$router.push("/notifications")),title:"通知"},[a[14]||(a[14]=r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),r("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})],-1)),e.notificationCount?(n(),c("span",V,k(e.notificationCount>99?"99+":e.notificationCount),1)):u("",!0)]),r("button",{class:"btn-icon",onClick:a[3]||(a[3]=a=>e.$router.push("/chat")),title:"消息"},[a[15]||(a[15]=r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})],-1)),te.value?(n(),c("span",H,k(te.value>99?"99+":te.value),1)):u("",!0)]),r("div",E,[r("img",{src:se.value.avatar||X,alt:se.value.username,class:"user-avatar",onClick:a[4]||(a[4]=e=>ae.value=!ae.value)},null,8,j),b(x,{name:"fade"},{default:w(()=>[ae.value?(n(),c("div",T,[r("div",q,[r("img",{src:se.value.avatar||X,alt:se.value.username},null,8,A),r("div",null,[r("div",L,k(se.value.username),1),r("div",O,"学号: "+k(se.value.studentId),1)])]),a[21]||(a[21]=r("div",{class:"menu-divider"},null,-1)),r("div",{class:"menu-item",onClick:a[5]||(a[5]=a=>e.$router.push("/profile"))},[...a[16]||(a[16]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),r("circle",{cx:"12",cy:"7",r:"4"})],-1),g(" 个人中心 ",-1)])]),r("div",{class:"menu-item",onClick:a[6]||(a[6]=a=>e.$router.push("/orders"))},[...a[17]||(a[17]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"}),r("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),r("path",{d:"M16 10a4 4 0 0 1-8 0"})],-1),g(" 我的订单 ",-1)])]),r("div",{class:"menu-item",onClick:a[7]||(a[7]=a=>e.$router.push("/chat"))},[...a[18]||(a[18]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})],-1),g(" 我的消息 ",-1)])]),1===se.value.role?(n(),c("div",{key:0,class:"menu-item",onClick:a[8]||(a[8]=a=>e.$router.push("/admin"))},[...a[19]||(a[19]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("rect",{x:"3",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"3",width:"7",height:"7"}),r("rect",{x:"14",y:"14",width:"7",height:"7"}),r("rect",{x:"3",y:"14",width:"7",height:"7"})],-1),g(" 管理后台 ",-1)])])):u("",!0),a[22]||(a[22]=r("div",{class:"menu-divider"},null,-1)),r("div",{class:"menu-item menu-item-danger",onClick:ne},[...a[20]||(a[20]=[r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"}),r("polyline",{points:"16,17 21,12 16,7"}),r("line",{x1:"21",y1:"12",x2:"9",y2:"12"})],-1),g(" 退出登录 ",-1)])])])):u("",!0)]),_:1})])],64)):(n(),c("button",{key:1,class:"btn-login",onClick:a[9]||(a[9]=a=>e.$router.push("/login"))}," 登录 "))])])]),a[29]||(a[29]=d('<section class="hero" data-v-9ebcc20b><div class="hero-content" data-v-9ebcc20b><h1 class="hero-title" data-v-9ebcc20b><span class="gradient-text" data-v-9ebcc20b>校园好物</span><br data-v-9ebcc20b>等你来淘 </h1><p class="hero-subtitle" data-v-9ebcc20b> 安全可靠的校园二手交易平台，让闲置物品焕发新生 </p></div><div class="hero-decoration" data-v-9ebcc20b><div class="floating-card card-1" data-v-9ebcc20b></div><div class="floating-card card-2" data-v-9ebcc20b></div><div class="floating-card card-3" data-v-9ebcc20b></div></div></section>',1)),r("section",J,[a[28]||(a[28]=r("div",{class:"section-header"},[r("h2",null,"最新发布"),r("p",null,"发现校园里的精选好物")],-1)),Z.value.length?(n(),c("div",N,[(n(!0),c(m,null,y(Z.value,s=>(n(),c("article",{key:s.id,class:"product-card",onClick:a=>e.$router.push(`/product/${s.id}`)},[r("div",F,[r("img",{src:s.mainImage,alt:s.title,class:"product-image",loading:"lazy"},null,8,K),a[23]||(a[23]=r("div",{class:"product-overlay"},[r("span",{class:"view-detail"},"查看详情")],-1))]),r("div",P,[r("h3",R,k(s.title),1),r("div",U,[r("span",G,"¥"+k(s.price),1),r("span",Q,[a[24]||(a[24]=r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[r("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),r("circle",{cx:"12",cy:"12",r:"3"})],-1)),g(" "+k(s.viewCount||0),1)])])])],8,D))),128))])):(n(),c("div",W,[a[25]||(a[25]=r("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[r("path",{d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})],-1)),a[26]||(a[26]=r("h3",null,"暂无商品",-1)),a[27]||(a[27]=r("p",null,"快来发布第一件商品吧",-1)),se.value?(n(),c("button",{key:0,class:"btn-primary",onClick:re}," 立即发布 ")):u("",!0)]))]),a[30]||(a[30]=r("footer",{class:"footer"},[r("div",{class:"footer-content"},[r("p",null,"© 2026 校园集市 · 让交易更简单")])],-1)),ae.value?(n(),c("div",{key:0,class:"overlay",onClick:a[10]||(a[10]=e=>ae.value=!1)})):u("",!0)]))}},[["__scopeId","data-v-9ebcc20b"]]);export{Y as default};
