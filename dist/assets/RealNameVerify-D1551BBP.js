import{_ as a,r as l,a as s,n as e,c as t,o as n,b as i,l as d,d as r,t as c,w as o,e as v,v as u,E as p}from"./index-DgsTEpUf.js";import{g as h,s as y}from"./verification-B-_pL_qt.js";import{r as f}from"./request-DczqgLPf.js";const m={class:"verify-page"},g={class:"navbar"},w={class:"nav-container"},k={class:"main-content"},b={key:0,class:"status-card success"},x={class:"info-card"},N={class:"info-row"},P={class:"value"},C={class:"info-row"},E={class:"value"},D={key:1,class:"status-card pending"},_={key:2,class:"status-card rejected"},B={class:"status-desc"},R={key:3,class:"form-card"},U={class:"form-group"},j={class:"form-group"},G={key:0,class:"upload-placeholder"},I={key:1,class:"upload-preview"},M=["src"],V=["disabled"],T=a({__name:"RealNameVerify",setup(a){const T=l(null),J=l(null),q=l(!1),z=l(null),A=s({realName:"",idPhotoUrl:""}),O=()=>{var a;null==(a=z.value)||a.click()},S=async a=>{const l=a.target.files[0];if(l)if(l.size>5242880)p.warning("图片大小不能超过5MB");else try{const a=await function(a){const l=new FormData;return l.append("file",a),f.post("/file/upload",l,{headers:{"Content-Type":"multipart/form-data"}})}(l);A.idPhotoUrl=a.data,p.success("上传成功")}catch(s){s._handled||p.error("上传失败")}},F=async()=>{if(A.realName.trim())if(A.idPhotoUrl){q.value=!0;try{await y(A),p.success("提交成功，请等待审核"),T.value="PENDING"}catch(a){a._handled||p.error(a.message||"提交失败")}finally{q.value=!1}}else p.warning("请上传证件照片");else p.warning("请输入真实姓名")};return e(async()=>{try{const a=await h();if(a.data){const l={0:"PENDING",1:"APPROVED",2:"REJECTED"};T.value=l[a.data.status]||null,J.value=a.data}}catch(a){}}),(a,l)=>{var s,e,p,h,y;return n(),t("div",m,[i("nav",g,[i("div",w,[i("button",{class:"btn-back",onClick:l[0]||(l[0]=l=>a.$router.back())},[...l[3]||(l[3]=[i("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[i("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),d(" 返回 ",-1)])]),l[4]||(l[4]=i("div",{class:"nav-brand"},"实名认证",-1))])]),i("main",k,["APPROVED"===T.value?(n(),t("div",b,[l[7]||(l[7]=r('<div class="status-icon" data-v-d61248a3><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-d61248a3><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" data-v-d61248a3></path><polyline points="22 4 12 14.01 9 11.01" data-v-d61248a3></polyline></svg></div><h2 data-v-d61248a3>认证已通过</h2><p class="status-desc" data-v-d61248a3>您已完成实名认证，享受完整平台功能</p>',3)),i("div",x,[i("div",N,[l[5]||(l[5]=i("span",{class:"label"},"真实姓名",-1)),i("span",P,c((y=null==(s=J.value)?void 0:s.realName,!y||y.length<2?y:y[0]+"*".repeat(y.length-1))),1)]),i("div",C,[l[6]||(l[6]=i("span",{class:"label"},"认证时间",-1)),i("span",E,c((h=null==(e=J.value)?void 0:e.reviewTime,h?new Date(h).toLocaleDateString("zh-CN"):"")),1)])])])):"PENDING"===T.value?(n(),t("div",D,[...l[8]||(l[8]=[r('<div class="status-icon" data-v-d61248a3><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-d61248a3><circle cx="12" cy="12" r="10" data-v-d61248a3></circle><polyline points="12 6 12 12 16 14" data-v-d61248a3></polyline></svg></div><h2 data-v-d61248a3>审核中</h2><p class="status-desc" data-v-d61248a3>您的认证申请正在审核，请耐心等待</p><p class="status-hint" data-v-d61248a3>通常1-3个工作日内完成审核</p>',4)])])):"REJECTED"===T.value?(n(),t("div",_,[l[9]||(l[9]=r('<div class="status-icon" data-v-d61248a3><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-d61248a3><circle cx="12" cy="12" r="10" data-v-d61248a3></circle><line x1="15" y1="9" x2="9" y2="15" data-v-d61248a3></line><line x1="9" y1="9" x2="15" y2="15" data-v-d61248a3></line></svg></div><h2 data-v-d61248a3>认证未通过</h2>',2)),i("p",B,c((null==(p=J.value)?void 0:p.rejectReason)||"信息有误，请重新提交"),1),i("button",{class:"btn-primary",onClick:l[1]||(l[1]=a=>T.value=null)},"重新认证")])):(n(),t("div",R,[l[15]||(l[15]=i("div",{class:"form-header"},[i("h2",null,"身份认证"),i("p",null,"完成实名认证后可享受更多平台功能")],-1)),i("form",{onSubmit:o(F,["prevent"])},[i("div",U,[l[10]||(l[10]=i("label",null,"真实姓名",-1)),v(i("input",{"onUpdate:modelValue":l[2]||(l[2]=a=>A.realName=a),type:"text",placeholder:"请输入您的真实姓名",maxlength:"20"},null,512),[[u,A.realName]])]),i("div",j,[l[13]||(l[13]=i("label",null,"证件照片",-1)),i("div",{class:"upload-area",onClick:O},[i("input",{ref_key:"fileInput",ref:z,type:"file",accept:"image/*",onChange:S,style:{display:"none"}},null,544),A.idPhotoUrl?(n(),t("div",I,[i("img",{src:A.idPhotoUrl,alt:"证件照片"},null,8,M),l[12]||(l[12]=i("div",{class:"preview-mask"},[i("span",null,"点击更换")],-1))])):(n(),t("div",G,[...l[11]||(l[11]=[r('<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-d61248a3><rect x="3" y="3" width="18" height="18" rx="2" ry="2" data-v-d61248a3></rect><circle cx="8.5" cy="8.5" r="1.5" data-v-d61248a3></circle><polyline points="21 15 16 10 5 21" data-v-d61248a3></polyline></svg><span data-v-d61248a3>点击上传学生证或身份证照片</span><span class="hint" data-v-d61248a3>支持 JPG、PNG 格式，大小不超过 5MB</span>',3)])]))])]),l[14]||(l[14]=i("div",{class:"form-tips"},[i("h4",null,"温馨提示"),i("ul",null,[i("li",null,"请确保证件照片清晰可辨认"),i("li",null,"姓名需与证件上的姓名一致"),i("li",null,"信息仅用于身份核验，我们将严格保护您的隐私")])],-1)),i("button",{type:"submit",class:"btn-submit",disabled:q.value},c(q.value?"提交中...":"提交认证"),9,V)],32)]))])])}}},[["__scopeId","data-v-d61248a3"]]);export{T as default};
