import{_ as a,r as e,n as l,c as t,o as s,b as i,h as u,y as n,j as r,i as o,e as d,U as c,k as p,l as v,K as m,V as g,t as f,B as y,F as w,C as _,E as b}from"./index-DgsTEpUf.js";import{i as h,j as k,r as C}from"./admin-jtg1Qoei.js";import"./request-DczqgLPf.js";const x={class:"page"},V={class:"page-header"},z={class:"filters"},j={class:"card"},E={class:"product-cell"},I={class:"img-error"},M={class:"product-info"},P={class:"title"},U={class:"price"},q={key:2,class:"muted"},K={class:"pagination"},B=a({__name:"ProductManage",setup(a){const B=e([]),D=e(!1),F=e(""),A=e(null),G=e(1),H=e(10),J=e(0),L={0:"待审核",1:"在售",2:"已下架",3:"已拒绝"},N=async()=>{var a,e;D.value=!0;try{const l=await h({keyword:F.value,status:A.value,page:G.value,size:H.value});B.value=(null==(a=l.data)?void 0:a.list)||[],J.value=(null==(e=l.data)?void 0:e.total)||0}finally{D.value=!1}},O=async(a,e)=>{let l="";if(e)await _.confirm("确定通过该商品审核吗？","审核商品");else{const{value:a}=await _.prompt("请输入拒绝原因","审核商品",{inputPattern:/.+/,inputErrorMessage:"请输入原因"});l=a}await k(a.id,e,l),b.success(e?"审核通过":"已拒绝"),N()};return l(N),(a,e)=>{const l=r("el-input"),h=r("el-option"),k=r("el-select"),Q=r("el-button"),R=r("el-table-column"),S=r("el-icon"),T=r("el-image"),W=r("el-table"),X=r("el-pagination"),Y=c("loading");return s(),t("div",x,[i("div",V,[e[4]||(e[4]=i("h1",{class:"page-title"},"商品管理",-1)),i("div",z,[u(l,{modelValue:F.value,"onUpdate:modelValue":e[0]||(e[0]=a=>F.value=a),placeholder:"搜索商品名称",clearable:"",style:{width:"200px"},onKeyup:n(N,["enter"])},null,8,["modelValue"]),u(k,{modelValue:A.value,"onUpdate:modelValue":e[1]||(e[1]=a=>A.value=a),placeholder:"状态",clearable:"",style:{width:"120px"},onChange:N},{default:o(()=>[u(h,{label:"待审核",value:0}),u(h,{label:"在售",value:1}),u(h,{label:"已下架",value:2})]),_:1},8,["modelValue"]),u(Q,{type:"primary",onClick:N},{default:o(()=>[...e[3]||(e[3]=[v("搜索",-1)])]),_:1})])]),i("div",j,[d((s(),p(W,{data:B.value},{default:o(()=>[u(R,{prop:"id",label:"ID",width:"70"}),u(R,{label:"商品","min-width":"280"},{default:o(({row:a})=>[i("div",E,[u(T,{src:a.mainImage,fit:"cover",class:"product-img"},{error:o(()=>[i("div",I,[u(S,null,{default:o(()=>[u(m(g))]),_:1})])]),_:1},8,["src"]),i("div",M,[i("span",P,f(a.title),1),i("span",U,"¥"+f(a.price),1)])])]),_:1}),u(R,{prop:"viewCount",label:"浏览",width:"80",align:"center"}),u(R,{label:"状态",width:"90",align:"center"},{default:o(({row:a})=>[i("span",{class:y(["status",["s"+a.status]])},f(L[a.status]),3)]),_:1}),u(R,{label:"操作",width:"160",fixed:"right"},{default:o(({row:a})=>[0===a.status?(s(),t(w,{key:0},[u(Q,{type:"primary",size:"small",text:"",onClick:e=>O(a,!0)},{default:o(()=>[...e[5]||(e[5]=[v("通过",-1)])]),_:1},8,["onClick"]),u(Q,{type:"danger",size:"small",text:"",onClick:e=>O(a,!1)},{default:o(()=>[...e[6]||(e[6]=[v("拒绝",-1)])]),_:1},8,["onClick"])],64)):1===a.status?(s(),p(Q,{key:1,type:"danger",size:"small",text:"",onClick:e=>(async a=>{const{value:e}=await _.prompt("请输入下架原因","下架商品",{inputPattern:/.+/,inputErrorMessage:"请输入原因"});await C(a.id,e),b.success("下架成功"),N()})(a)},{default:o(()=>[...e[7]||(e[7]=[v("下架",-1)])]),_:1},8,["onClick"])):(s(),t("span",q,"-"))]),_:1})]),_:1},8,["data"])),[[Y,D.value]]),i("div",K,[u(X,{"current-page":G.value,"page-size":H.value,total:J.value,background:"",layout:"total, prev, pager, next",onCurrentChange:e[2]||(e[2]=a=>{G.value=a,N()})},null,8,["current-page","page-size","total"])])])])}}},[["__scopeId","data-v-50084e61"]]);export{B as default};
