import{_ as s,m as a,r as t,n as e,c,o as r,b as l,l as o,B as d,F as i,x as n,z as u,u as p,t as v,C as m,E as k}from"./index-DgsTEpUf.js";import{g as y,a as b,b as C,d as g,e as h}from"./order-CFFxLi2s.js";import"./request-DczqgLPf.js";const I={class:"orders-page"},f={class:"navbar"},w={class:"nav-container"},T={class:"main-content"},x={class:"tabs"},_={class:"orders-list"},q={class:"order-header"},j={class:"order-no"},N=["onClick"],$=["src","alt"],B={class:"order-info"},M={class:"order-price"},O={class:"order-time"},S={class:"order-actions"},z=["onClick"],E=["onClick"],F=["onClick"],H=["onClick"],J={key:0,class:"empty-state"},A={class:"order-header"},D={class:"order-no"},G=["onClick"],K=["src","alt"],L={class:"order-info"},P={class:"order-price"},Q={class:"order-time"},R={class:"order-actions"},U=["onClick"],V=["onClick"],W={key:0,class:"empty-state"},X=s({__name:"Orders",setup(s){const X=p(),Y=a(()=>JSON.parse(localStorage.getItem("userInfo")||"{}")),Z=t("buy"),ss=t([]),as=t([]),ts={0:{text:"待完成",class:"warning"},1:{text:"已完成",class:"success"},2:{text:"已取消",class:"info"}},es=async()=>{if(Y.value.id){try{const s=await y(Y.value.id);ss.value=(s.data||[]).map(s=>({...s,productTitle:s.productTitle||"商品已删除",productImage:s.productImage||""}))}catch(s){}try{const s=await b(Y.value.id);as.value=(s.data||[]).map(s=>({...s,productTitle:s.productTitle||"商品已删除",productImage:s.productImage||""}))}catch(s){}}},cs=async s=>{await m.confirm("确定删除此订单？删除后无法恢复","删除订单"),await h(s.id,Y.value.id),k.success("订单已删除"),es()};return e(es),(s,a)=>(r(),c("div",I,[l("nav",f,[l("div",w,[l("button",{class:"btn-back",onClick:a[0]||(a[0]=a=>s.$router.back())},[...a[3]||(a[3]=[l("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[l("path",{d:"M19 12H5M12 19l-7-7 7-7"})],-1),o(" 返回 ",-1)])]),a[4]||(a[4]=l("div",{class:"nav-brand"},"我的订单",-1))])]),l("main",T,[l("div",x,[l("button",{class:d({active:"buy"===Z.value}),onClick:a[1]||(a[1]=s=>Z.value="buy")}," 我买到的 ",2),l("button",{class:d({active:"sell"===Z.value}),onClick:a[2]||(a[2]=s=>Z.value="sell")}," 我卖出的 ",2)]),l("div",_,["buy"===Z.value?(r(),c(i,{key:0},[(r(!0),c(i,null,u(ss.value,a=>(r(),c("div",{key:a.id,class:"order-card"},[l("div",q,[l("span",j,"订单号："+v(a.orderNo),1),l("span",{class:d(["order-status",ts[a.status].class])},v(ts[a.status].text),3)]),l("div",{class:"order-body",onClick:t=>s.$router.push("/product/"+a.productId)},[l("img",{src:a.productImage,alt:a.productTitle,class:"order-image"},null,8,$),l("div",B,[l("h4",null,v(a.productTitle),1),l("p",M,"¥"+v(a.amount),1),l("p",O,v(a.createTime),1)])],8,N),l("div",S,[0===a.status?(r(),c("button",{key:0,class:"btn-primary",onClick:s=>(async s=>{await m.confirm("确认已收到商品？","确认收货"),await C(s.id),k.success("确认收货成功"),es()})(a)}," 确认收货 ",8,z)):n("",!0),0===a.status?(r(),c("button",{key:1,class:"btn-secondary",onClick:s=>(async s=>{await m.confirm("确定取消订单？","取消订单"),await g(s.id),k.success("订单已取消"),es()})(a)}," 取消订单 ",8,E)):n("",!0),0!==a.status?(r(),c("button",{key:2,class:"btn-danger",onClick:s=>cs(a)}," 删除订单 ",8,F)):n("",!0),l("button",{class:"btn-secondary",onClick:s=>(s=>X.push({path:"/chat",query:{userId:s.sellerId}}))(a)}," 联系卖家 ",8,H)])]))),128)),ss.value.length?n("",!0):(r(),c("div",J,[...a[5]||(a[5]=[l("p",null,"暂无订单",-1)])]))],64)):(r(),c(i,{key:1},[(r(!0),c(i,null,u(as.value,a=>(r(),c("div",{key:a.id,class:"order-card"},[l("div",A,[l("span",D,"订单号："+v(a.orderNo),1),l("span",{class:d(["order-status",ts[a.status].class])},v(ts[a.status].text),3)]),l("div",{class:"order-body",onClick:t=>s.$router.push("/product/"+a.productId)},[l("img",{src:a.productImage,alt:a.productTitle,class:"order-image"},null,8,K),l("div",L,[l("h4",null,v(a.productTitle),1),l("p",P,"¥"+v(a.amount),1),l("p",Q,v(a.createTime),1)])],8,G),l("div",R,[0!==a.status?(r(),c("button",{key:0,class:"btn-danger",onClick:s=>cs(a)}," 删除订单 ",8,U)):n("",!0),l("button",{class:"btn-secondary",onClick:s=>(s=>X.push({path:"/chat",query:{userId:s.buyerId}}))(a)}," 联系买家 ",8,V)])]))),128)),as.value.length?n("",!0):(r(),c("div",W,[...a[6]||(a[6]=[l("p",null,"暂无订单",-1)])]))],64))])])]))}},[["__scopeId","data-v-fc079ac1"]]);export{X as default};
